<!doctype html>
<head>
  <meta charset="utf-8">
  <title>iNews - Local News for You</title>

  <link rel="stylesheet" href="lib/angular-material/angular-material.css">
  <link rel='stylesheet' type='text/css' href='/assets/css/main.css'>
  <link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
  <link href="https://fonts.googleapis.com/css?family=Bitter:700" rel="stylesheet">
</head>
<body ng-app='inews' ng-controller="appCtrl" ng-cloak>
  
  <base href="/">
  
  <div class='navbar' style="border-bottom: 1px solid #dcdcdc; height: 5em;">
    <img class='logo' src='/assets/worldwide-location-24.jpg'></img>
    <span style="font-size: 2em; line-height: 2.5em; font-weight: 700; font-family: 'Bitter', serif;">iNews</span>
    <div class='loginbox' style="position: relative; top: 1em;">
    <md-button style="background-image: url(http://comparegang.com/wp-content/uploads/2016/09/Meetup_Logo_2015-300x204.png); background-size: contain; background-repeat: no-repeat; padding-left: 4em;" ng-hide='isAuth()' ng-click="meetupshow($event)" class="md-raised">
      Sign In With Meetup
    </md-button>
    <md-button ng-hide='isAuth()' ng-click="signinshow($event)" class="md-raised">
      Sign In
    </md-button>
    <md-button ng-hide='isAuth()' ng-click="signupshow($event)" class="md-raised">
      Sign Up
    </md-button>
    <md-button ng-show='isAuth()' ng-click="logout()" class="md-raised">
      Sign Out
    </md-button>
  </div>
    <p>{{error}}</p>
  </div>
  <div class='border' style='border-bottom: 1px solid #dcdcdc'></div>

  <!-- TOPIC WRAPPER -->
  <div class="news-topic-wrapper">
    <span ng-repeat="topic in topics">
      <span class="news-topic">
        {{ topic.title }}
        <i class="fa fa-times-circle news-topic-btn"
           aria-hidden="true"
           ng-click="removeTopic($index)"></i>
      </span>
    </span>
    
    <form style="display:inline-block" ng-submit="addNewsTopic()">
      <md-input-container class="md-block" style="vertical-align:top; height: 2em; font-size:0.8em; display:inline-block; margin-top: 0.4em">
      <label class="placeholder" style="line-height:1.1em">Add topic...</label>
      <input ng-model="newTopicInput"></input>
      <i class="fa fa-check-circle" style="display: flex; line-height:1.4em; cursor:pointer"></i>
      </md-input-container>
    </form>
  </div>

  <!-- WEATHER WRAPPER -->
  <div layout='row' layout-sm="column" layout-margin>
    <div flex>
      <div class="border">
        <div class="news-wrapper-topic">
          <span class="news-wrapper-topic-title">Weather</span>
          
          <md-button class="news-wrapper-topic-btn"
                     ng-click="newsSettings()"
                     aria-label="Settings">
            <i class="fa fa-cogs" aria-hidden="true"></i>
          </md-button>
        </div>

        <md-card class="md-padding weather" md-theme-watch>
          <div class="weather-icon">
            <img class="main-weather-icon" src="{{weather.current.current_observation.icon_url}}"></img>
          </div>
          <div class="weather-description">
            <div class="weather-description-title">{{weather.current.current_observation.dewpoint_f}} degrees now</div>
            <div class="weather-description-details">
            Feels like {{weather.current.current_observation.feelslike_f}}
            </div>
            <div class="weather-description-location">{{weather.current.current_observation.observation_location.city}}</div>
            <div class="weather-time-last-update">{{weather.current.current_observation.observation_time}}</div>
            <div class="weather-description-icons">
            <div class="weather-description-icons-wrapper">
              <div class="weather-description-icons-icon">
                <img src="{{weather.forecast.forecast.txt_forecast.forecastday[1].icon_url}}"></img>
              </div>
              <p class="weather-description-icons-text">{{weather.forecast.forecast.txt_forecast.forecastday[1].title}}</p>
            </div>
            <div class="weather-description-icons-wrapper">
              <div class="weather-description-icons-icon">
                  <img src="{{weather.forecast.forecast.txt_forecast.forecastday[2].icon_url}}"></img>
              </div>
              <p class="weather-description-icons-text">{{weather.forecast.forecast.txt_forecast.forecastday[2].title}}</p>
            </div>
            <div class="weather-description-icons-wrapper">
              <div class="weather-description-icons-icon">
                  <img src="{{weather.forecast.forecast.txt_forecast.forecastday[3].icon_url}}"></img>
              </div>
              <p class="weather-description-icons-text">{{weather.forecast.forecast.txt_forecast.forecastday[3].title}}</p>
            </div>
            <div class="weather-description-icons-wrapper">
              <div class="weather-description-icons-icon">
                  <img src="{{weather.forecast.forecast.txt_forecast.forecastday[4].icon_url}}"></img>
              </div>
              <p class="weather-description-icons-text">{{weather.forecast.forecast.txt_forecast.forecastday[4].title}}</p>
            </div>
            <div class="weather-description-icons-wrapper">
              <div class="weather-description-icons-icon">
                <img src="{{weather.forecast.forecast.txt_forecast.forecastday[5].icon_url}}"></img>
              </div>
              <p class="weather-description-icons-text">{{weather.forecast.forecast.txt_forecast.forecastday[5].title}}</p>
            </div>
            </div>
          </div>
        </md-card>
      </div>

    </div>
  </div>

  <!-- EVENTS WRAPPER -->
  <div layout='row' layout-sm="column" layout-margin>
    <div flex>
      <div class="border" ng-init="meetupObject.limit = 1">
        <div class="news-wrapper-topic" style="background-color:{{meetupObject.color}};">
          <span class="news-wrapper-topic-title">{{ meetupObject.title }}</span>

          <md-button class="news-wrapper-topic-btn"
                     ng-click='meetupObject.limit = meetupObject.limit === 1 ? meetupObject.meetups.length: 1'
                     aria-label="Show more or less">
            <i class="fa fa-chevron-circle-down" aria-hidden="true"></i>
          </md-button>

          <md-button class="news-wrapper-topic-btn"
                     aria-label="Settings">
            <i class="fa fa-cogs" aria-hidden="true"></i>
          </md-button>
        </div>

        <md-card class="md-padding"
                 ng-repeat='meetup in meetupObject.meetups | limitTo:meetupObject.limit||1'
                 md-theme-watch>
          <md-card-title>
            <md-card-title-text>
              <span class="md-headline">{{ meetup.name }}</span>
              <span class="md-subhead">{{ meetup.description}}</span>
            </md-card-title-text>
            <md-card-title-media>
              <div class="md-media-lg card-media" style="background-image:url({{news.image.thumbnail.contentUrl}})"></div>
            </md-card-title-media>
          </md-card-title>
          <md-card-actions layout="row" layout-align="end center">
            <md-button>Action 2</md-button>
          </md-card-actions>
        </md-card>
      </div>

    </div>
  </div>

  <!-- NEWS WRAPPER -->
  <div layout='row' layout-sm="column" layout-margin>
    <div flex>
      <div class="border" ng-repeat="newsfeed in newsfeeds" ng-init="newsfeed.limit = 1">
        <div class="news-wrapper-topic" style="background-color:{{newsfeed.color}};">
          <span class="news-wrapper-topic-title">{{ newsfeed.title }}</span>

          <md-button class="news-wrapper-topic-btn"
                     ng-click='newsfeed.limit = newsfeed.limit === 1 ? newsfeed.newsItems.value.length: 1'
                     aria-label="Show more or less">
            <i class="fa fa-chevron-circle-down" aria-hidden="true"></i>
          </md-button>

          <md-button class="news-wrapper-topic-btn"
                     ng-click="newsSettings()"
                     aria-label="Settings">
            <i class="fa fa-cogs" aria-hidden="true"></i>
          </md-button>
        </div>

        <md-card class="md-padding"
                 ng-repeat='news in newsfeed.newsItems.value | limitTo:newsfeed.limit||1'
                 md-theme-watch>
          <md-card-title>
            <md-card-title-text>
              <span class="md-headline">{{news.name}}</span>
              <span class="md-subhead">{{news.description}}</span>
            </md-card-title-text>
            <md-card-title-media>
              <div class="md-media-lg card-media" style="background-image:url({{news.image.thumbnail.contentUrl}})"></div>
            </md-card-title-media>
          </md-card-title>
          <md-card-actions layout="row" layout-align="end center" style="justify-content: space-between">
            <md-button ng-disabled="true" style="float:left" aria-label="date">{{ news.datePublished | date:'HH:mm, MMM dd'}}</md-button>
            <a href="{{news.url}}" target="_blank" style="color:inherit; text-decoration:none; margin-right:0.3em">
            <md-button>Read more</md-button>
            </a>
          </md-card-actions>
        </md-card>
      </div>

    </div>
  </div>

  <div style="visibility: hidden">
    <div class="md-dialog-container" id="signInDialog">
      <md-dialog>
        <form name="loginForm" data-ng-submit="login()">
          <md-dialog-content>
              <div class="md-dialog-content">
                  <md-input-container class="md-block">
                      <label>Username:</label>
                      <input ng-model="user.username" required>
                  </md-input-container>

                  <md-input-container class="md-block">
                      <label>Password:</label>
                      <input ng-model="user.password" type="password" required>
                  </md-input-container>
              </div>
          </md-dialog-content>
          <md-dialog-actions layout="row">
              <span flex></span>
              <md-button type="submit" class="md-primary"
                         ng-class="{'md-raised': (loginForm.$dirty && loginForm.$valid) }">
                  OK
              </md-button>
              <md-button type="button" ng-click="signinCancel(); $event.stopPropagation();">
                  Cancel
              </md-button>
          </md-dialog-actions>
        </form>
      </md-dialog>
    </div>
  </div>

  <div style="visibility: hidden">
    <div class="md-dialog-container" id="signUpDialog">
      <md-dialog>
        <form name="signupForm" data-ng-submit="signup()">
          <md-dialog-content>
              <div class="md-dialog-content">
                  <md-input-container class="md-block">
                      <label>Username:</label>
                      <input ng-model="user.username" required>
                  </md-input-container>

                  <md-input-container class="md-block">
                      <label>Password:</label>
                      <input ng-model="user.password" type="password" required>
                  </md-input-container>

                  <md-input-container class="md-block">
                      <label>Password Confirm:</label>
                      <input ng-model="user.confirm" type="password" required>
                  </md-input-container>
              </div>
          </md-dialog-content>
          <md-dialog-actions layout="row">
              <span flex></span>
              <md-button type="submit" class="md-primary"
                         ng-class="{'md-raised': (signupForm.$dirty && signupForm.$valid) }">
                  OK
              </md-button>
              <md-button type="button" ng-click="signupCancel(); $event.stopPropagation();">
                  Cancel
              </md-button>
          </md-dialog-actions>
        </form>
      </md-dialog>
    </div>
  </div>

  <footer>
    <p>&copy; iNews 2016</p>
  </footer>

  <script src="lib/angular/angular.js"></script>
  <script src="lib/angular-animate/angular-animate.js"></script>
  <script src="lib/angular-aria/angular-aria.js"></script>
  <script src="lib/angular-material/angular-material.js"></script>
  <script src="lib/angular-route/angular-route.js"></script>

  <script src="app/services/authService.js"></script>
  <script src="app/services/httpService.js"></script>
  <script src="app/services/newsService.js"></script>
  <script src="app/app.js"></script>
</body>
</html>
